# Docker

-   **Docker** : 컨테이너 기반의 오픈소스 가상화 플랫폼 </br>
    -> 다양한 프로그램, 실행환경을 컨테이너로 추상화하고 어디든 실행할 수 있도록 함
    </br>

-   **컨테이너** : 격리된 공간에서 프로세스가 동작하는 기술 </br>
-   **이미지** : 컨테이너 실행에 필요힌 파일과 설정값 등을 포함하고 있는 것 -> 상태값을 가지지 않고 변하지 않음
    </br>-> 우분투 이미지 : 우분투를 실행하기 위한 모든 파일을 가짐
    </br>-> 마이에스큐엘 이미지 : 마이에스큐엘을 실행하기 위헤 필요한 파일과 실행 명령어, 포트 정보 등을 가짐 </br>
    </br> 도커는 이미지를 만들기 위해 dockerfile이라는 파일에 자체 언어를 이용하여 이미지 생성 과정을 작성
    </br>이미지는 컨테이너가 실행되기 위한 모든 정보를 가지고 있기 때문에 새로운 서버가 추가되면 미리 만들어 둔 이미지를 다운받고 컨테이너를 생성하기만 하면 됨

## Dockerfile

1.  베이스 이미지(Base Image) 설정
    먼저, 어떤 베이스 이미지를 기반으로 할지 정해야 합니다.
    </br>베이스 이미지는 기본적인 운영체제와 필요한 환경을 포함하고 있습니다.
    </br>예를 들어, Node.js 기반의 애플리케이션을 만들 때는 Node.js를 설치한 베이스 이미지를 선택합니다.
    ```
    FROM node:14-alpine
    ```
2.  작업 디렉토리 설정
    컨테이너 안에서 작업할 디렉토리를 설정합니다. 이 디렉토리가 컨테이너 안에서 모든 파일의 기본 경로가 됩니다.

        WORKDIR /app

3.  파일 복사
    호스트 머신의 파일을 컨테이너로 복사합니다. 애플리케이션 파일, 소스 코드, 라이브러리 등이 포함될 수 있습니다.
    COPY package.json yarn.lock ./
    COPY src/ ./src/`
4.  의존성 설치
    필요한 라이브러리를 설치합니다.
    ```
    RUN npm install
    ```
5.  애플리케이션 실행
    컨테이너가 시작되면 실행할 명령어를 정의
    ```
    CMD ["yarn", "start"]
    ```

## docker-compose.yml

1. version: Compose 파일의 버전을 지정합니다.
   </br>현재 version '3'은 가장 널리 사용되는 버전입니다.
   </br>다양한 버전에서 지원하는 기능이 다르므로 적절한 버전을 선택해야 합니다.
2. services: 여러 개의 서비스(컨테이너)를 정의합니다.
   </br>각 서비스는 이미지 이름 또는 Dockerfile 경로를 지정하여 어떤 이미지로 실행할지를 결정합니다.
   </br>필요에 따라 서비스에 환경 변수, 포트 매핑, 볼륨 매핑 등의 설정을 추가할 수 있습니다.
3. volumes: 여러 개의 볼륨을 정의합니다.
   </br>볼륨을 사용하여 컨테이너의 데이터를 호스트 머신이나 다른 컨테이너와 공유하고 영구적으로 저장할 수 있습니다.
4. networks: 여러 개의 네트워크를 정의합니다.
   </br>네트워크를 사용하여 컨테이너 간의 통신을 구성하거나 외부 네트워크와 연결할 수 있습니다.

    ```
    version: '3'
    services:
    service1:
        # service1의 설정

    service2:
        # service2의 설정

    volumes:
    volume1:
        # volume1의 설정

    networks:
    network1:
        # network1의 설정
    ```
